<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SVOX Pico libpicotts: Picosa</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SVOX Pico libpicotts
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Picosa</div>  </div>
</div><!--header-->
<div class="contents">
<p>internal buffers:</p>
<ul>
<li>headx: array for extended item heads of fixed size (head plus index for content, plus two fields for boundary strength/type)</li>
<li>cbuf1, cbuf2: buffers for item contents (referenced by index in headx). Future: replace these two buffers by a single double-sided buffer (double shrink-grow type)</li>
</ul>
<p>0. bottom up filling of items in headx and cbuf1</p>
<ol type="1">
<li>POS disambiguation (right-to-left, top-to-bottom):</li>
</ol>
<ul>
<li>number and sequence of items unchanged</li>
<li>item content can only get smaller (reducing nr of results in WORDINDEX) -&gt; info stays in "headx, cbuf1" and changed in place <br  />
 WORDGRAPH(POSes,NA)graph -&gt; WORDGRAPH(POS,NA)graph <br  />
 WORDINDEX(POSes,NA)POS1ind1...POSNindN -&gt; WORDINDEX(POS,NA)POS|ind <br  />
</li>
</ul>
<ol type="1">
<li>lex-index lookup and G2P (both directions possible, left-to-right done):</li>
</ol>
<ul>
<li>number and sequence of items unchanged, item head info and content changes -&gt; headx changed in place; cbuf1 to cbuf2 <br  />
 WORDGRAPH(POS,NA)graph -&gt; WORDPHON(POS,NA)phon <br  />
 WORDINDEX(POS,NA)POS|ind -&gt; WORDPHON(POS,NA)phon <br  />
</li>
</ul>
<ol type="1">
<li>phrasing (right-to-left):</li>
</ol>
<h2><a class="anchor" id="autotoc_md11"></a>
Previous (before introducing SBEG)\n</h2>
<p>1| 2| 3| 4| <br  />
 e.g. from WP WP WP WP WP PUNC WP WP PUNC WP WP WP PUNC FLUSH <br  />
 e.g. to BINIT WP WP WP BPHR3 WP WP BPHR1 WP WP BSEND WP WP WP BSEND BTERM <br  />
 |1 |2 |3 |4 <br  />
 3-level bound state: to keep track of bound strength from end of previous punc-phrase, then BOUND item output as first item (strength from prev punc-phrase and type from current punc-phrase).</p>
<p>trailing PUNC item bound states INIT SEND PHR1 PUNC(SENTEND, T) B(I,T)&gt;SEND B(S,T)&gt;SEND B(P1,T)&gt;SEND PUNC(SENTEND, Q) B(I,Q)&gt;SEND B(S,Q)&gt;SEND B(P1,Q)&gt;SEND PUNC(SENTEND, E) B(I,E)&gt;SEND B(S,E)&gt;SEND B(P1,E)&gt;SEND PUNC(PHRASEEND, P) B(I,P)&gt;PHR1 B(S,P)&gt;PHR1 B(P1,P)&gt;PHR1 PUNC(PHRASEEND, FORC) B(I,P)&gt;PHR1 B(S,P)&gt;PHR1 B(P1,P)&gt;PHR1 PUNC(FLUSH, T) B(I,T).. B(S,T).. B(P1,T).. B(T,NA) B(T,NA) B(T,NA) &gt;INIT &gt;INIT &gt;INIT</p>
<p>PHR2/3 case: trailing PUNC item bound states INIT SEND PHR1 PUNC(SENTEND, T) B(I,P)B(P,T)&gt;SEND B(S,P)B(P,T)&gt;SEND B(P1,P)B(P,T)&gt;SEND PUNC(SENTEND, Q) B(I,P)B(P,Q)&gt;SEND B(S,P)B(P,Q)&gt;SEND B(P1,P)B(P,Q)&gt;SEND PUNC(SENTEND, E) B(I,P)B(P,E)&gt;SEND B(S,P)B(P,E)&gt;SEND B(P1,P)B(P,E)&gt;SEND PUNC(PHRASEEND, P) B(I,P)B(P,P)&gt;PHR1 B(S,P)B(P,P)&gt;PHR1 B(P1,P)B(P,P)&gt;PHR1 PUNC(PHREND, FORC) B(I,P)B(P,P)&gt;PHR1 B(S,P)B(P,P)&gt;PHR1 B(P1,P)B(P,P)&gt;PHR1 PUNC(FLUSH, T) B(I,P)B(P,T).. B(S,T)B(P,T).. B(P1,T)B(P,T).. B(T,NA) B(T,NA) B(T,NA) &gt;INIT &gt;INIT &gt;INIT</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Current</h2>
<p>e.g. from WP WP WP WP WP PUNC WP WP PUNC WP WP WP PUNC FLUSH e.g. to BSBEG WP WP WP BPHR3 WP WP BPHR1 WP WP BSEND BSBEG WP WP WP BSEND BTERM |1 |2 |3 |4</p>
<p>2-level bound state: The internal buffer contains one primary phrase (sometimes forced, if buffer allmost full), with the trailing PUNCT item included (last item). If the trailing PUNC is a a primary phrase separator, the item is not output, but instead, the bound state is set to PPHR, so that the correct BOUND can be output at the start of the next primary phrase. Otherwise, the item is converted to the corresponding BOUND and output. the bound state is set to SSEP, so that a BOUND of type SBEG is output at the start of the next primary phrase.</p>
<p>trailing PUNC item bound states SSEP PPHR PUNC(SENTEND, X) B(B,X)&gt;SSEP B(P1,X)&gt;SSEP (X = T | Q | E) PUNC(FLUSH, T) B(B,T)&gt;SSEP* B(P1,T)&gt;SSEP PUNC(PHRASEEND, P) B(B,P)&gt;PPHR B(P1,P)&gt;PPHR PUNC(PHRASEEND, FORC) B(B,P)&gt;PPHR B(P1,P)&gt;PPHR</p>
<p>If more than one sentence separators follow each other (e.g. SEND-FLUSH, SEND-SEND) then all but the first will be treated as an (empty) phrase containing just this item. If this (single) item is a flush, creation of SBEG is suppressed.</p>
<ul>
<li>dtphr phrasing tree (rather subphrasing tree it should be called) determines BOUND_PHR2 BOUND_PHR3</li>
<li>boundary strenghts are determined for every word (except the first one) from right-to-left. The boundary types mark the phrase type of the phrase following the boundary.</li>
<li>number of items actually changed (new BOUND items added): because of fixed size without content, two fields are contained in headx to indicate if a BOUND needs to be added to the LEFT of the item. -&gt; headx further extended with boundary strength and type info to indicate that to the left of the headx ele a BOUND needs to be inserted when outputting.</li>
</ul>
<ol type="1">
<li>accentuation:</li>
</ol>
<ul>
<li><p class="startli">number of items unchanged, content unchanged, only head info changes -&gt; changed in place in headx</p>
<p class="startli">------------------------------------------------&mdash;<br  />
 <b> Pico Sentence analysis </b><br  />
 ------------------------------------------------&mdash;<br  />
 itemtype, iteminfo1, iteminfo2, content -&gt; TYPE(INFO1,INFO2)content in the following</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md13"></a>
items input</h1>
<p>processed by sa (POS disambiguation):</p><ul>
<li>WORDGRAPH(POSes,NA)graph</li>
<li>WORDINDEX(POSes,NA)POS|1ind1...POSN|indN</li>
<li>CMD(PICODATA_ITEMINFO1_CMD_FLUSH,PICODATA_ITEMINFO2_NA)</li>
</ul>
<p>processed by sa (Phrasing, Accentuation):</p><ul>
<li>PUNC(PUNCtype,PUNCsubtype)</li>
</ul>
<p>unprocessed:</p><ul>
<li>all other item types are forwarded through the PU without modification: CMD</li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
minimal input size (before processing starts)</h1>
<p>processing (POS disambiguation, g2p, lexind, phrasing, accentuation) is possible with</p>
<ul>
<li>one punctuation-phrase, consisting of a sequence (see below for limits) of items terminated by a PUNC item.</li>
</ul>
<p>(possible but not implemented: as long as the internal buffer is empty, non-processed item types can be processed immediately)</p>
<p>Ensuring terminal PUNC item:</p><ul>
<li>when reading items from the external buffer a CMD(...FLUSH...) is converted to a PUNC(...FLUSH...) item</li>
<li>If needed, a PUNC(PHRASE) is artificially added to ensure a phrase fits in the PUs memory and processing can start.</li>
</ul>
<h1><a class="anchor" id="autotoc_md15"></a>
items processed and output</h1>
<p>precondition: CMD(...FLUSH...) already converted to PUNC(...FLUSH...) and trailing PUNC item enforced if necessary.</p>
<hr  />
<ol type="1">
<li>PROCESS_POSD: processing input WORDGRAPH or WORDINDEX items, after POS disambiguation (POSes -&gt; POS), results in a sequence of:</li>
</ol>
<p>-&gt; WORDGRAPH(POS,NA)graph -&gt; WORDINDEX(POS,NA)POS|ind</p>
<hr  />
<ol type="1">
<li>PROCESS_WPHO: then, after lex-index lookup and G2P in a sequence of:</li>
</ol>
<p>-&gt; WORDPHON(POS,NA)phon</p>
<p>(phon containing primary and secondary word-level stress)</p>
<hr  />
<ol type="1">
<li>PROCESS_PHR: then, after processing these WORDPHON items, together with the trailing PUNC item results in:</li>
</ol>
<p>-&gt; BOUND(BOUNDstrength,BOUNDtype)</p>
<p>being added in the sequence of WORDPHON (respectively inserted instead of the PUNC). All PUNC, incl PUNC(...FLUSH...) now gone.</p>
<hr  />
<ol type="1">
<li>PROCESS_ACC: then, after processing the WORDPHON and BOUND items results in:</li>
</ol>
<p>-&gt; WORDPHON(POS,ACC)phon</p>
<p>A postprocessing step of accentuation is hard-coded in the accentuation module: In case the whole word does not have any stress at all (primary or secondary or both) then do the following mapping:</p>
<p>ACC0 nostress -&gt; ACC0 ACC1 nostress -&gt; ACC3 ACC2 nostress -&gt; ACC3 ACC3 nostress -&gt; ACC3</p>
<hr  />
<ul>
<li>POS a single, unambiguous POS</li>
</ul>
<p>cf. <a class="el" href="picodata_8h.html">picodata.h</a> for</p><ul>
<li>ACC (sentence-level accent (aka prominence)) d PICODATA_ACC0 PICODATA_ACC1 PICODATA_ACC2 (&lt;- maybe mapped to ACC1, ie. no ACC2 in output) PICODATA_ACC3</li>
<li>BOUNDstrength d PICODATA_ITEMINFO1_BOUND_SBEG (at sentence start) PICODATA_ITEMINFO1_BOUND_SEND (at sentence end) PICODATA_ITEMINFO1_BOUND_TERM (replaces a flush) PICODATA_ITEMINFO1_BOUND_PHR1 (primary boundary) PICODATA_ITEMINFO1_BOUND_PHR2 (short break) PICODATA_ITEMINFO1_BOUND_PHR3 (secondary phrase boundary, no break) PICODATA_ITEMINFO1_BOUND_PHR0 (no break, not produced by sa, not existing BOUND in item sequence equals PHR0 bound strength)</li>
<li>BOUNDtype (created in sa base on punctuation, indicates type of phrase following the boundary) d PICODATA_ITEMINFO2_BOUNDTYPE_P PICODATA_ITEMINFO2_BOUNDTYPE_T PICODATA_ITEMINFO2_BOUNDTYPE_Q PICODATA_ITEMINFO2_BOUNDTYPE_E</li>
</ul>
<p>output sequence (without CMDs):</p>
<p>&lt;output&gt; = { BOUND(BOUND_SBEG,PHRASEtype) &lt;sentence&gt; BOUND(BOUND_SEND,..)} BOUND(BOUND_TERM,..)</p>
<p>&lt;sentence&gt; = &lt;phrase&gt; { BOUND(BOUND_PHR1|2|3,BOUNDtype) &lt;phrase&gt; }</p>
<p>&lt;phrase&gt; = WORDPHON(POS,ACC)phon { WORDPHON(POS,ACC)phon }</p>
<p>Done in later PU: mapping ACC &amp; word-level stress to syllable accent value ACC0 prim -&gt; 0 ACC1 prim -&gt; 1 ACC2 prim -&gt; 2 ACC3 prim -&gt; 3 ACC0 sec -&gt; 0 ACC1 sec -&gt; 4 ACC2 sec -&gt; 4 ACC3 sec -&gt; 4</p>
<h1><a class="anchor" id="autotoc_md21"></a>
other limitations</h1>
<ul>
<li>item size: header plus len=256 (valid for Pico in general)</li>
<li>see defines below for max nr of items. Item heads plus ref. to contents buffer are stored in array with fixed size elements. Two restrictions:<ul>
<li>MAXNR_HEADX (max nr elements==items in headx array)</li>
<li>CONTENTSSIZE (max size of all contents together </li>
</ul>
</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 21 2021 17:46:27 for SVOX Pico libpicotts by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
